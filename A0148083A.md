# A0148083A
###### \docs\UserGuide.md
``` md

### Adding a task: `add`
Adds a task to the task management<br>
Format: `add TITLE d/DESCRIPTION [sd/START_DATE] [dd/DUE_DATE] [i/INTERVAL] [ti/TIME_INTERVAL] [-t TAG 1, TAG 2...] ...` 

> Tasks can have any number of tags (including 0)

Examples: 
* `add Homework d/ProgrammingEx1`

<a id="add_task" class="anchor" aria-hidden="true">
#### Adding an Event
Adds a task which has a start time and end time. 
User has to specify TITLE, DESCRIPTION, START_DATE and DUE_DATE.
* `add Birthday Party d/Edwin's birthday party sd/08-01-2012 10:00 dd/08-01-2012 23:00`
* `add Soccer match d/Champion League sd/08-01-2012 18:00 dd/08-01-2012 20:00 i/8 ti/7`
	
#### Adding a Deadline
Adds a task that have to be done before a specific deadline. 
User has to specify TITLE, DESCRIPTION and DUE_DATE.
* `add Homework d/ProgrammingEx1 dd/10-01-2012`
* `add Take home Lab d/ProgrammingEx1 dd/10-01-2012 23:59 i/4 ti/7`

#### Adding a Floating Task
Adds a task without specific times. 
User has to specify TITLE, DESCRIPTION.
* `add Homework d/ProgrammingEx1`
* `add Assignment d/Math i/4 ti/7`

```
###### \src\main\java\seedu\task\logic\commands\AddCommand.java
``` java
			//to focus on the latest added task
			EventsCenter.getInstance().post(new JumpToListRequestEvent(model.getFilteredTaskList().size() - 1));
```
###### \src\main\java\seedu\task\logic\commands\DoneCommand.java
``` java
public class DoneCommand extends Command {
    
    public static final String COMMAND_WORD = "done";

    public static final String MESSAGE_USAGE = COMMAND_WORD
            + ": Mark a task as completed which is identified by the index number used in the last task listing.\n"
            + "Parameters: INDEX (must be a positive integer)\n"
            + "Example: " + COMMAND_WORD + " 1";
    
    public static final String MESSAGE_COMPLETED_TASK_SUCCESS = "Completed Task: %1$s";
	public static final String MESSAGE_SUCCESS_UNDO = "Undo of done command";
	public static final String MESSAGE_ALREADY_COMPLETED = "The task is already done.";
	public final String MESSAGE_DUPLICATE = "The task is a duplicate of an existing task.";
	public final String MESSAGE_NOT_FOUND = "The task was not found.";
    
    public int targetIndex;
    public String targetStatus;
    
    public DoneCommand(int targetIndex) {
        this.targetIndex = targetIndex;
    }
    
```
###### \src\main\java\seedu\task\logic\commands\DoneCommand.java
``` java
    @Override
    public CommandResult execute() {

        UnmodifiableObservableList<ReadOnlyTask> lastShownList = model.getFilteredTaskList();

        if (lastShownList.size() < targetIndex) {
            indicateAttemptToExecuteIncorrectCommand();
            return new CommandResult(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
        }

        ReadOnlyTask taskToComplete = lastShownList.get(targetIndex - 1);

        targetStatus= taskToComplete.getStatus().status;
        if(targetStatus.equals("COMPLETED"))
        	return new CommandResult(MESSAGE_ALREADY_COMPLETED);
        
        try {
            ReadOnlyTask completedTask = taskToComplete;
            completedTask.setStatus(new Status("COMPLETED"));
            model.completeTask(taskToComplete, completedTask);
            //to focus on the completed task
            EventsCenter.getInstance().post(new JumpToListRequestEvent(model.getFilteredTaskList().size() - 1));
            
            
        } catch (TaskNotFoundException pnfe) {
			//remove this command from list for undo
			model.getCommandForUndo();
            assert false : MESSAGE_NOT_FOUND;
        }
        

        return new CommandResult(String.format(MESSAGE_COMPLETED_TASK_SUCCESS, taskToComplete));
    }
```
###### \src\main\java\seedu\task\logic\commands\EditCommand.java
``` java
            //to focus on the latest edited task
            EventsCenter.getInstance().post(new JumpToListRequestEvent(realIndex));
```
###### \src\main\java\seedu\task\logic\parser\Parser.java
``` java
			// For deadlines - if there is startDate, set dueDatePrefix as
			// required
			if (argsTokenizer.getValue(startDatePrefix) != null) {
				dueDatePrefix.SetIsOptional(false);
			}
```
###### \src\main\java\seedu\task\logic\parser\Parser.java
``` java
	private String isInputPresent(String input) {
		return input == null ? "Not Set" : input;
	}
```
###### \src\main\java\seedu\task\logic\parser\Parser.java
``` java
	private Command prepareDone(String args) {

		Optional<Integer> index = parseIndex(args);
		if (!index.isPresent()) {
			return new IncorrectCommand(String.format(MESSAGE_INVALID_COMMAND_FORMAT, DoneCommand.MESSAGE_USAGE));
		}

		return new DoneCommand(index.get());
	}
```
###### \src\main\java\seedu\task\model\Model.java
``` java
    /** Complete the given task. */
    void completeTask(ReadOnlyTask target, ReadOnlyTask toBeComplete) throws UniqueTaskList.TaskNotFoundException;
```
###### \src\main\java\seedu\task\model\ModelManager.java
``` java
    @Override
    public synchronized void completeTask(ReadOnlyTask target, ReadOnlyTask toBeComplete) throws TaskNotFoundException {
        taskManager.completeTask(target, toBeComplete);
        indicateTaskManagerChanged();
    }
```
###### \src\main\java\seedu\task\model\task\Description.java
``` java
public class Description {

    public String fullDescription;
    public static final String MESSAGE_DESCRIPTION_CONSTRAINTS = "Description can't be empty.";
    
    public Description(String description) throws IllegalValueException {
        if (description.equals("Not Set")) {
            this.fullDescription = "";
        }
        else if (!isValidDate(description)) {
            throw new IllegalValueException(MESSAGE_DESCRIPTION_CONSTRAINTS);
        }
        description = description.trim();
        this.fullDescription = description;
    }
    
    public static boolean isValidDate(String description) {
    	if(description.isEmpty())
    		return false;
        return true;
      }
    
    @Override
    public String toString() {
        return fullDescription;
    }
    
    @Override
    public boolean equals(Object other) {
        return other == this // short circuit if same object
                || (other instanceof Description // instanceof handles nulls
                && this.fullDescription.equals(((Description) other).fullDescription)); // state check
    }

    @Override
    public int hashCode() {
        return fullDescription.hashCode();
    }
}
```
###### \src\main\java\seedu\task\model\task\DueDate.java
``` java
//Represents a Task's(event) start date in the task manager.
public class DueDate {

  
    public static final String MESSAGE_DATE_CONSTRAINTS = "Task's due date should be entered as DD-MM-YYYY hh:mm\n"
            + "EXAMPLE: add Homework d/Math homework dd/02-01-2011 23:59";
    public static final SimpleDateFormat DATE_FORMAT = new SimpleDateFormat("dd-MM-yyyy HH:mm");
    
    public static final SimpleDateFormat DATE_FORMAT_WITHOUT_TIME = new SimpleDateFormat("dd-MM-yyyy");
  
    public final Date dueDate;

    public DueDate(String dateToValidate) throws IllegalValueException, ParseException {
        if (dateToValidate.equals("Not Set")) {
            this.dueDate = null;
        }
        else if (!isValidDateTime(dateToValidate) && !isValidDate(dateToValidate)) {
            throw new IllegalValueException(MESSAGE_DATE_CONSTRAINTS);
        }
        else {
            if (!isValidDateTime(dateToValidate)) {
                this.dueDate = DATE_FORMAT.parse(dateToValidate + " 23:59");
            }
            else {
                this.dueDate = DATE_FORMAT.parse(dateToValidate);
            }
        }
    }
  
	public DueDate(Date date) {
		dueDate = date;
	}

	public static boolean isValidDateTime(String inDate) {
		DATE_FORMAT.setLenient(false);
		try {
			DATE_FORMAT.parse(inDate.trim());
		} catch (ParseException pe) {
			return false;
		}
		return true;
	}
	
	public static boolean isValidDate(String inDate){
	    DATE_FORMAT_WITHOUT_TIME.setLenient(false);
	    try{
	        DATE_FORMAT_WITHOUT_TIME.parse(inDate.trim());
	    }
	    catch (ParseException pe){
	        return false;
	    }
	    return true;
	}

	@Override
	public String toString() {
		return dueDate == null ? "Not Set" : DATE_FORMAT.format(dueDate);
	}

	@Override
	public boolean equals(Object other) {
		if (other == null)
			return false;
		return other == this // short circuit if same object
				|| (other instanceof DueDate // instanceof handles nulls
			    && ((DueDate) other).dueDate != null
			    && this.dueDate.equals(((DueDate) other).dueDate)); // state
																			// check
	}

	@Override
	public int hashCode() {
		return dueDate.hashCode();
	}

}
```
###### \src\main\java\seedu\task\model\task\DueDate.java
``` java

```
###### \src\main\java\seedu\task\model\task\ReadOnlyTask.java
``` java
    Title getTitle();
    Description getDescription();
    StartDate getStartDate();
    DueDate getDueDate();
    Interval getInterval();
    TimeInterval getTimeInterval();
    Status getStatus();
    void setStatus(Status status);
```
###### \src\main\java\seedu\task\model\task\ReadOnlyTask.java
``` java
    /**
     * Formats the task as text, showing all contact details.
     */
    default String getAsText() {
        final StringBuilder builder = new StringBuilder();
        builder.append(getTitle())
                .append(" Description: ")
                .append(getDescription())
                .append(" Start Date: ")
                .append(getStartDate())
                .append(" Due Date: ")
                .append(getDueDate())
                .append(" Status: ")
                .append(getStatus())
                .append(" Tags: ");
        getTags().forEach(builder::append);
        return builder.toString();
    }
```
###### \src\main\java\seedu\task\model\task\StartDate.java
``` java
//Represents a Task's(event) start date in the task manager.
public class StartDate {

	public static final String MESSAGE_DATE_CONSTRAINTS = "Task's start date should be entered as DD-MM-YYYY hh:mm\n"
	        +"Example: add Homework d/Math homework sd/01-01-2011 00:00 dd/03-01-2011 23:59";
	public static final SimpleDateFormat DATE_FORMAT = new SimpleDateFormat("dd-MM-yyyy HH:mm");

	public static final SimpleDateFormat DATE_FORMAT_WITHOUT_TIME = new SimpleDateFormat("dd-MM-yyyy");
	
	public final Date startDate;

	public StartDate(String dateToValidate) throws IllegalValueException, ParseException {
		if (dateToValidate.equals("Not Set")) {
			this.startDate = null;
		} else if (!isValidDateTime(dateToValidate) && !isValidDate(dateToValidate)) {
			throw new IllegalValueException(MESSAGE_DATE_CONSTRAINTS);
		}
		else {
            if (!isValidDateTime(dateToValidate)) {
                this.startDate = DATE_FORMAT.parse(dateToValidate + " 08:00");
            }
            else {
                this.startDate = DATE_FORMAT.parse(dateToValidate);
            }
        }
	}

	public StartDate(Date date) {
		startDate = date;
	}

	public static boolean isValidDateTime(String inDate) {
		DATE_FORMAT.setLenient(false);
		try {
			DATE_FORMAT.parse(inDate.trim());
		} catch (ParseException pe) {
			return false;
		}
		return true;
	}
	
	public static boolean isValidDate(String inDate){
        DATE_FORMAT_WITHOUT_TIME.setLenient(false);
        try{
            DATE_FORMAT_WITHOUT_TIME.parse(inDate.trim());
        }
        catch (ParseException pe){
            return false;
        }
        return true;
    }

	@Override
	public String toString() {
		return startDate == null ? "Not Set" : DATE_FORMAT.format(startDate);
	}

	@Override
	public boolean equals(Object other) {
	      return other == this // short circuit if same object
	              || (other instanceof StartDate // instanceof handles nulls
	              && ((StartDate) other).startDate != null
	              && this.startDate.equals(((StartDate) other).startDate)); // state check
	}

	@Override
	public int hashCode() {
		return startDate.hashCode();
	}

}
```
###### \src\main\java\seedu\task\model\task\Task.java
``` java

```
###### \src\main\java\seedu\task\model\task\UniqueTaskList.java
``` java
    public boolean complete(ReadOnlyTask toRemove, ReadOnlyTask toReplaceWith) throws TaskNotFoundException {
        assert toRemove != null;
        assert toReplaceWith != null;
        final boolean taskFoundAndDeleted = internalList.remove(toRemove);
        if (!taskFoundAndDeleted) {
            throw new TaskNotFoundException();
        }
        internalList.add((Task)toReplaceWith);
        return taskFoundAndDeleted;
    }

    public ObservableList<Task> getInternalList() {
        return internalList;
    }

    @Override
    public Iterator<Task> iterator() {
        return internalList.iterator();
    }

    @Override
    public boolean equals(Object other) {
        return other == this // short circuit if same object
                || (other instanceof UniqueTaskList // instanceof handles nulls
                && this.internalList.equals(
                ((UniqueTaskList) other).internalList));
    }

    @Override
    public int hashCode() {
        return internalList.hashCode();
    }
}
```
###### \src\main\java\seedu\task\model\TaskManager.java
``` java
    //Mark a task as completed
    public boolean completeTask(ReadOnlyTask target, ReadOnlyTask toBeComplete) throws UniqueTaskList.TaskNotFoundException {
        if (tasks.complete(target, toBeComplete)) {
            return true;
        } else {
            throw new UniqueTaskList.TaskNotFoundException();
        }
    }
```
###### \src\main\java\seedu\task\ui\TaskCard.java
``` java
    @FXML
    public void initialize() {
    	title.setText(task.getTitle().fullTitle);
        id.setText(displayedIndex + ". ");
        description.setText(task.getDescription().fullDescription);
        startDate.setText("Start Date: " + isDateNull(task.getStartDate().startDate));
        dueDate.setText("Due Date: " + isDateNull(task.getDueDate().dueDate));
        status.setText(task.getStatus().status.toString());
        tags.setText(task.tagsString());
```
###### \src\test\java\guitests\guihandles\TaskCardHandle.java
``` java
    public boolean isSameTask(ReadOnlyTask task){
        SimpleDateFormat dateFormat = new SimpleDateFormat("E dd-MM-yyyy HH:mm");
    	return getTitle().equals(task.getTitle().fullTitle) && getDescription().equals(task.getDescription().fullDescription)
                && getStartDate().equals("Start Date: " + dateFormat.format(task.getStartDate().startDate)) && getDueDate().equals("Due Date: " + dateFormat.format(task.getDueDate().dueDate))
                && getStatus().equals(task.getStatus().status);
    }
```
###### \src\test\java\seedu\address\logic\LogicManagerTest.java
``` java
    @Test
    public void execute_add_event_noDueDate() throws Exception {
        String expectedMessage = String.format(MESSAGE_INVALID_COMMAND_FORMAT, String.format(AddCommand.MESSAGE_TASK_USAGE, "due date"));
        assertCommandBehavior("add event d/without due date sd/12-12-2016", expectedMessage);
    }
    
    @Test
    public void execute_add_event_dueDateBeforeStartDate() throws Exception {
        String expectedMessage = String.format(MESSAGE_INVALID_COMMAND_FORMAT, AddCommand.MESSAGE_INVALID_DATE);
        assertCommandBehavior("add event d/due date before start date sd/12-12-2016 dd/01-01-2016", expectedMessage);
    }
    
	@Test
	public void execute_add_successful() throws Exception {
		// setup expectations
		TestDataHelper helper = new TestDataHelper();
		Task toBeAdded = helper.homework();
		TaskManager expectedAB = new TaskManager();
		String expectedMessage = String.format(AddCommand.MESSAGE_SUCCESS, toBeAdded.getAsText());
		expectedAB.addTask(toBeAdded);

		// execute command and verify result
		assertCommandBehavior(helper.generateAddCommand(toBeAdded), expectedMessage, expectedAB, expectedAB.getTaskList());
	}
	
//	@Test
//    public void execute_add_deadline_withoutTimeInDate() throws Exception {
//	    TestDataHelper helper = new TestDataHelper();
//        Task toBeAdded = new Task(
//                new Title("Task "),
//                new Description("Description "),
//                new StartDate("Not Set"),
//                new DueDate("01-01-2016"),
//                new Interval("1"),
//                new TimeInterval("7"),
//                new Status("ONGOING"),
//                new TaskColor("none"),
//                new UniqueTagList(new Tag("tag" + Math.abs(1)), new Tag("tag" + Math.abs(2))));
//        TaskManager expectedAB = new TaskManager();
//        String expectedTask = toBeAdded.getAsText();
//	    String expectedMessage = String.format(AddCommand.MESSAGE_SUCCESS, expectedTask);
//	    String command = helper.generateAddCommand(toBeAdded).replaceAll("sd/Not Set ", "").replaceAll("23:59 ", "");
//        assertCommandBehavior(command, expectedMessage, expectedAB, expectedAB.getTaskList());
//	}
```
###### \src\test\java\seedu\address\logic\LogicManagerTest.java
``` java
    @Test
    public void execute_doneInvalidArgsFormat_errorMessageShown() throws Exception {
        String expectedMessage = String.format(MESSAGE_INVALID_COMMAND_FORMAT, DoneCommand.MESSAGE_USAGE);
        assertIncorrectIndexFormatBehaviorForCommand("done", expectedMessage);
    }

    @Test
    public void execute_doneIndexNotFound_errorMessageShown() throws Exception {
        assertIndexNotFoundBehaviorForCommand("done");
    }
    
    @Test
    public void execute_doneOnCompletedTask() throws Exception {
        TestDataHelper helper = new TestDataHelper();
        List<Task> oneTasks = helper.generateTaskList(1);
        helper.addToModel(model, oneTasks);
        String expectedMessage = DoneCommand.MESSAGE_ALREADY_COMPLETED;
        CommandResult result = logic.execute("done 1");
        
        TaskManager expectedAB = helper.generateTaskManager(oneTasks);

        assertCommandBehavior("done 1",
                expectedMessage,
                expectedAB,
                expectedAB.getTaskList());
        
    }
    
    @Test
    public void execute_done_success() throws Exception {
        TestDataHelper helper = new TestDataHelper();
        List<Task> oneTasks = helper.generateTaskList(1);
        helper.addToModel(model, oneTasks);
        String expectedTask = oneTasks.get(0).getAsText().replaceAll("ONGOING", "COMPLETED");
        String expectedMessage = String.format(DoneCommand.MESSAGE_COMPLETED_TASK_SUCCESS, expectedTask);
        TaskManager expectedAB = helper.generateTaskManager(oneTasks);
        assertCommandBehavior("done 1", expectedMessage, expectedAB, expectedAB.getTaskList());
    }
```
